<html>
<head>
	<title>jQuery SugarSync</title>
	<link href="./css/test.css" rel="stylesheet" type="text/css">
	<script src="./libs/jquery-1.9.1.js" type="text/javascript"></script>
	<script src="./jquery.sugarsync.js" type="text/javascript"></script>
	<script>
		var _sMagicBriefcaseResource=null;
		$(document).ready(function(){
			$('#getUserInfo').click(function(){
				$(document).sugarsync({
					username: $('#username').val(),
					password: $('#pwd').val()
				}).sugarsync('getUserInfo',function(oResult){
					var _sHtml='';
					for(var i in oResult)_sHtml+='<b>'+i+':</b> '+oResult[i]+'<br>';
					$('#getUserInfo_result').html(_sHtml);
					$('#getFolderInfo').attr('disabled',null);
					$('#getFolderContents').attr('disabled',null);
					_sMagicBriefcaseResource=oResult.magicBriefcase;
				});
			});
			
			$('#getFolderInfo').click(function(){
				$(document).sugarsync({
					username: $('#username').val(),
					password: $('#pwd').val()
				}).sugarsync('getFolderInfo',_sMagicBriefcaseResource,function(oResult){
					var _sHtml='';
					for(var i in oResult)_sHtml+='<b>'+i+':</b> '+oResult[i]+'<br>';
					$('#getFolder_result').html(_sHtml);
				});
			});
			
			$('#getFolderContents').click(function(){
				$(document).sugarsync({
					username: $('#username').val(),
					password: $('#pwd').val()
				}).sugarsync('getFolderContents',_sMagicBriefcaseResource,fillFolderContentsResult);
			});
		});
		
		function fillFolderContentsResult(aResult){
			var _aHtml=[];
			for(var i in aResult){
				var _oElement=aResult[i];
				switch( _oElement.type ){
					case 'folder':
						_aHtml.push('<li class="folder" onClick="$(document).sugarsync(\'getFolderContents\',\'' + _oElement.ref + '\',fillFolderContentsResult)" ><b>'+_oElement.displayName+'</b></li>');
					break;
					case 'file':
						_aHtml.push('<li class="file" ><label class="name" >'+_oElement.displayName+'</label><label class="size" >'+_oElement.size+' bytes</label><label class="last-modified" >Last modified: '+_oElement.lastModified+'</label><label class="media-type" >'+_oElement.mediaType+'</label></li>');
						//'<li class="file" onClick="if(confirm(\'Start Download?\'))$(document).sugarsync(\'download\',\'' + _oElement.fileData + '\')" >'+_oElement.displayName+'</li>'
					default:
					break;
				}
			}
			$('#getFolder_result').html('<ul>' + _aHtml.join('') + '</ul>');
		}
	</script>
</head>
<body>
	<table>
		<tr>
			<td id="title" >jQuery <a href="https://www.sugarsync.com/" >SugarSync</a> v0.0.2</td>
		</tr>
		<tr>
			<td>
				<div><label>USERNAME:</label><input type="text" id="username" ></input></div>
				<div><label>PASSWORD:</label><input type="password" id="pwd" ></input></div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="div-title" >get User Info</div>
				<div id="getUserInfo_result" class="div-result" ></div>
				<input type="button" id="getUserInfo" class="input-button" value="getUserInfo"></input>
			</td>
		</tr>
		<tr>
			<td>
				<div class="div-title" >getFolder Info or Contents</div>
				<div id="getFolder_result" class="div-result" ></div>
				<input type="button" id="getFolderInfo" class="input-button" value="getFolderInfo (magic briefcase)" disabled></input>
				<input type="button" id="getFolderContents" class="input-button" value="getFolderContents (magic briefcase)" disabled></input>
			</td>
		</tr>
	</table>
</body>
</html>